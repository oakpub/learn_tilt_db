# Требования к проекту

## Введение

Данный проект представляет собой систему из двух независимых тестовых микросервисов для изучения Kubernetes. Каждый микросервис имеет свою собственную базу данных PostgreSQL с персистентным хранилищем. Проект использует Helm для управления Kubernetes манифестами и Tilt для автоматизации разработки. Ключевой особенностью является модульная архитектура - каждый микросервис можно включать/отключать независимо, при этом его база данных и персистентное хранилище создаются только при необходимости.

## Требования

### Требование 1

**Пользовательская история:** Как разработчик, изучающий Kubernetes, я хочу иметь два независимых тестовых микросервиса, каждый со своей базой данных, чтобы понять основы работы с микросервисной архитектурой.

#### Критерии приемки

1. КОГДА я запускаю команду развертывания ТОГДА система ДОЛЖНА создать первый микросервис с его PostgreSQL
2. КОГДА я запускаю команду развертывания ТОГДА система ДОЛЖНА создать второй микросервис с его PostgreSQL
3. КОГДА микросервисы запущены ТОГДА каждый ДОЛЖЕН быть доступен через отдельный Service в Kubernetes
4. КОГДА PostgreSQL запущен для микросервиса ТОГДА только этот микросервис ДОЛЖЕН подключаться к своей базе данных

### Требование 2

**Пользовательская история:** Как разработчик, я хочу использовать Helm для управления конфигурацией, чтобы легко настраивать различные параметры развертывания.

#### Критерии приемки

1. КОГДА я использую Helm chart ТОГДА система ДОЛЖНА позволять настройку через values.yaml
2. КОГДА я изменяю параметры в values.yaml ТОГДА система ДОЛЖНА применять эти изменения при развертывании
3. КОГДА я устанавливаю chart ТОГДА все ресурсы ДОЛЖНЫ создаваться с правильными метками и аннотациями
4. КОГДА я удаляю chart ТОГДА все созданные ресурсы ДОЛЖНЫ быть корректно удалены

### Требование 3

**Пользовательская история:** Как разработчик, я хочу использовать персистентное хранилище для каждой базы данных PostgreSQL отдельно, чтобы данные каждого микросервиса сохранялись независимо.

#### Критерии приемки

1. КОГДА PostgreSQL первого микросервиса запускается ТОГДА система ДОЛЖНА создать отдельный PersistentVolumeClaim для его данных
2. КОГДА PostgreSQL второго микросервиса запускается ТОГДА система ДОЛЖНА создать отдельный PersistentVolumeClaim для его данных
3. КОГДА под PostgreSQL любого микросервиса перезапускается ТОГДА данные этого микросервиса ДОЛЖНЫ сохраняться
4. КОГДА я создаю таблицы в базе одного микросервиса ТОГДА они НЕ ДОЛЖНЫ влиять на базу другого микросервиса

### Требование 4

**Пользовательская история:** Как разработчик, я хочу иметь возможность условно отключать персистентное хранилище для каждого микросервиса отдельно, чтобы гибко управлять конфигурацией в разных средах развертывания.

#### Критерии приемки

1. КОГДА параметр persistence.enabled установлен в false для первого микросервиса ТОГДА система НЕ ДОЛЖНА создавать PersistentVolumeClaim для его PostgreSQL
2. КОГДА параметр persistence.enabled установлен в false для второго микросервиса ТОГДА система НЕ ДОЛЖНА создавать PersistentVolumeClaim для его PostgreSQL
3. КОГДА персистентное хранилище отключено для микросервиса ТОГДА его PostgreSQL ДОЛЖЕН использовать emptyDir volume
4. КОГДА я настраиваю разные профили развертывания ТОГДА каждый микросервис ДОЛЖЕН независимо управлять своим персистентным хранилищем
5. КОГДА персистентное хранилище отключено для микросервиса ТОГДА данные его базы ДОЛЖНЫ удаляться при удалении пода

### Требование 5

**Пользовательская история:** Как разра��отчик, я хочу использовать Tilt для автоматизации разработки, чтобы быстро видеть изменения в коде и конфигурации.

#### Критерии приемки

1. КОГДА я запускаю tilt up ТОГДА система ДОЛЖНА автоматически собирать и развертывать сервисы
2. КОГДА я изменяю код веб-сервера ТОГДА Tilt ДОЛЖЕН автоматически пересобрать и передеплоить контейнер
3. КОГДА я изменяю Helm values ТОГДА Tilt ДОЛЖЕН автоматически обновить развертывание
4. КОГДА я открываю Tilt UI ТОГДА я ДОЛЖЕН видеть статус всех сервисов и логи

### Требование 6

**Пользовательская история:** Как разработчик, я хочу иметь подробную документацию, чтобы понимать как настроить и использовать проект.

#### Критерии приемки

1. КОГДА я читаю документацию ТОГДА она ДОЛЖНА содержать пошаговые инструкции по установке
2. КОГДА я следую документации ТОГДА я ДОЛЖЕН успешно запустить проект с первого раза
3. КОГДА я изучаю примеры ТОГДА они ДОЛЖНЫ быть рабочими и актуальными
4. КОГДА я ищу информацию о конфигурации ТОГДА документация ДОЛЖНА содержать описание всех параметров

### Требование 7

**Пользовательская история:** Как разработчик, я хочу иметь модульную архитектуру, чтобы развертывать только необходимые микросервисы в разных средах.

#### Критерии приемки

1. КОГДА я устанавливаю чарт ТОГДА система ДОЛЖНА позволять включать/отключать каждый микросервис независимо через параметры
2. КОГДА первый микросервис отключен ТОГДА система НЕ ДОЛЖНА создавать его ресурсы и его PostgreSQL
3. КОГДА второй микросервис отключен ТОГДА система НЕ ДОЛЖНА создавать его ресурсы и его PostgreSQL
4. КОГДА я создаю профиль только с первым микросервисом ТОГДА система ДОЛЖНА развертывать только его компоненты
5. КОГДА я создаю профиль только со вторым микросервисом ТОГДА система ДОЛЖНА развертывать только его компоненты

### Требование 8

**Пользовательская история:** Как разработчик, я хочу иметь простой веб-интерфейс для проверки работы системы, чтобы визуально убедиться в корректности развертывания.

#### Критерии приемки

1. КОГДА я открываю веб-интерфейс ТОГДА он ДОЛЖЕН показывать статус подключения к базе данных
2. КОГДА я выполняю тестовые операции ТОГДА веб-интерфейс ДОЛЖЕН отображать результаты
3. КОГДА база данных недоступна ТОГДА веб-интерфейс ДОЛЖЕН показывать соответствующее сообщение об ошибке
4. КОГДА я обновляю страницу ТОГДА информация ДОЛЖНА актуализироваться